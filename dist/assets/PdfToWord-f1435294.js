import{j as e}from"./index-425a4db3.js";import{r as l}from"./vendor-8a332d8f.js";import{P as H}from"./PDFButton-bafdfd11.js";import{P as X,a as z,F as M}from"./PdfProgress-f427ce92.js";import{P as Y}from"./PdfToolWrapper-bef57729.js";import{G,g as k}from"./pdf-b223739c.js";import{F as w,aM as p,a1 as L,E as A,T as _}from"./ui-86c81d4e.js";import"./router-2c18f3be.js";import"./tslib.es6-1f0a9ae4.js";G.workerSrc=new URL("pdfjs-dist/build/pdf.worker.min.js",self.location).toString();const ae=()=>{const[c,F]=l.useState(null),[a,x]=l.useState({format:"docx",preserveFormatting:!0,extractImages:!1,includeHeaders:!0,includeFooters:!0,pageBreaks:!0}),[u,g]=l.useState("idle"),[P,i]=l.useState(0),[C,n]=l.useState(""),[h,f]=l.useState(null),[j,T]=l.useState(0),[q,y]=l.useState(""),[v,N]=l.useState(""),D=l.useCallback(async t=>{if(t.length>0){const r=t[0];F(r),g("idle"),i(0),n(""),f(null),y(""),N("");try{const s=await r.arrayBuffer(),o=(await H.load(s)).getPageCount();T(o),await S(s),n(`PDF loaded with ${o} pages`)}catch(s){console.error("Error loading PDF:",s),n("Failed to load PDF file")}}},[]),S=async t=>{try{const o=(await(await(await k(t).promise).getPage(1)).getTextContent()).items.filter(m=>"str"in m).map(m=>m.str).join(" ");N(o.substring(0,500)+(o.length>500?"...":""))}catch(r){console.error("Error extracting preview text:",r)}},B=async t=>{const r=await k(t).promise;let s="";for(let d=1;d<=r.numPages;d++){const $=(await(await r.getPage(d)).getTextContent()).items.filter(b=>"str"in b).map(b=>b.str).join(" ");s+=$,a.pageBreaks&&d<r.numPages&&(s+=`

--- Page Break ---

`),i(20+d/r.numPages*60)}return s},E=t=>{const r=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">
  <w:body>`,s=`  </w:body>
</w:document>`,d=t.split(`

`).map(o=>o.trim()?`    <w:p>
      <w:r>
        <w:t>${o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}</w:t>
      </w:r>
    </w:p>`:"").join(`
`);return r+`
`+d+`
`+s},U=t=>{const r="{\\rtf1\\ansi\\deff0 {\\fonttbl {\\f0 Times New Roman;}}",s="}",d=t.replace(/\\/g,"\\\\").replace(/\{/g,"\\{").replace(/\}/g,"\\}").split(`

`).map(o=>o.trim()?`\\par ${o}`:"").join(`
`);return r+`
`+d+`
`+s},O=async()=>{if(!c){g("error"),n("Please upload a PDF file first.");return}try{g("processing"),i(0),n("Loading PDF document...");const t=await c.arrayBuffer();i(10),n("Extracting text from PDF...");const r=await B(t);y(r),i(80),n("Converting to Word format...");let s,d,o;switch(a.format){case"docx":s=E(r),d="application/vnd.openxmlformats-officedocument.wordprocessingml.document",o="docx";break;case"rtf":s=U(r),d="application/rtf",o="rtf";break;case"txt":s=r,d="text/plain",o="txt";break;default:throw new Error("Unsupported format")}i(90),n("Finalizing conversion...");const m=new Blob([s],{type:d});f(m),i(100),g("success"),n(`Successfully converted PDF to ${a.format.toUpperCase()}!`)}catch(t){console.error("Error converting PDF:",t),g("error"),n("Failed to convert PDF. Please ensure the file is a valid PDF with text content.")}},W=()=>{var t;if(h){const r=a.format,s=`converted-${(t=c==null?void 0:c.name)==null?void 0:t.replace(".pdf","")}.${r}`;M.saveAs(h,s)}},I=e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(w,{className:"w-5 h-5 text-red-500"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Upload PDF File"})]}),e.jsx(X,{onFilesSelected:D,multiple:!1,accept:{"application/pdf":[".pdf"]},disabled:u==="processing"})]}),c&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(p,{className:"w-5 h-5 text-red-500"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Conversion Settings"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Output Format"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{value:"docx",label:"DOCX",desc:"Word Document"},{value:"rtf",label:"RTF",desc:"Rich Text Format"},{value:"txt",label:"TXT",desc:"Plain Text"}].map(t=>e.jsxs("button",{onClick:()=>x(r=>({...r,format:t.value})),className:`p-3 rounded-lg border-2 transition-all text-center ${a.format===t.value?"border-red-500 bg-red-50 dark:bg-red-900/30":"border-gray-200 dark:border-gray-600 hover:border-red-300"}`,children:[e.jsx("div",{className:"font-medium text-sm",children:t.label}),e.jsx("div",{className:"text-xs text-gray-500",children:t.desc})]},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Conversion Options"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:a.preserveFormatting,onChange:t=>x(r=>({...r,preserveFormatting:t.target.checked})),className:"rounded border-gray-300 text-red-600 focus:ring-red-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Preserve formatting (where possible)"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:a.pageBreaks,onChange:t=>x(r=>({...r,pageBreaks:t.target.checked})),className:"rounded border-gray-300 text-red-600 focus:ring-red-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Include page breaks"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:a.includeHeaders,onChange:t=>x(r=>({...r,includeHeaders:t.target.checked})),className:"rounded border-gray-300 text-red-600 focus:ring-red-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Include headers"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:a.includeFooters,onChange:t=>x(r=>({...r,includeFooters:t.target.checked})),className:"rounded border-gray-300 text-red-600 focus:ring-red-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Include footers"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:a.extractImages,onChange:t=>x(r=>({...r,extractImages:t.target.checked})),className:"rounded border-gray-300 text-red-600 focus:ring-red-500",disabled:!0}),e.jsx("span",{className:"text-sm text-gray-500",children:"Extract images (coming soon)"})]})]})]}),e.jsxs("button",{onClick:O,disabled:!c||u==="processing",className:"w-full px-4 py-3 bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white font-medium rounded-lg transition-colors disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:[e.jsx(L,{className:"w-5 h-5"}),e.jsxs("span",{children:["Convert to ",a.format.toUpperCase()]})]})]})]}),e.jsx(z,{status:u,progress:P,message:C,onDownload:W,downloadFileName:h?`converted.${a.format}`:void 0}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-red-900 dark:text-red-100 mb-2",children:"How to use PDF to Word:"}),e.jsxs("ul",{className:"text-sm text-red-800 dark:text-red-200 space-y-1",children:[e.jsx("li",{children:"• Upload a PDF file using the upload area above"}),e.jsx("li",{children:"• Choose output format (DOCX, RTF, or TXT)"}),e.jsx("li",{children:"• Configure conversion options as needed"}),e.jsx("li",{children:'• Click "Convert" to extract text from PDF'}),e.jsx("li",{children:"• Download the converted file when processing is complete"}),e.jsx("li",{children:"• Note: Only text content is extracted, complex layouts may not be preserved"})]})]})]}),R=e.jsx("div",{className:"space-y-6",children:c&&j>0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(A,{className:"w-5 h-5 text-red-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Conversion Preview"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:j}),e.jsx("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:"Pages"})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.format.toUpperCase()}),e.jsx("div",{className:"text-sm text-green-800 dark:text-green-200",children:"Output Format"})]}),e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:(c.size/1024/1024).toFixed(1)}),e.jsx("div",{className:"text-sm text-purple-800 dark:text-purple-200",children:"MB Size"})]})]}),v&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Text Preview (First Page)"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 max-h-48 overflow-y-auto",children:e.jsx("pre",{className:"text-sm text-gray-900 dark:text-gray-100 whitespace-pre-wrap font-mono",children:v})})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Conversion Settings"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Format:"}),e.jsx("span",{className:"font-medium",children:a.format.toUpperCase()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Page breaks:"}),e.jsx("span",{className:"font-medium",children:a.pageBreaks?"Yes":"No"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Preserve formatting:"}),e.jsx("span",{className:"font-medium",children:a.preserveFormatting?"Yes":"No"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Include headers:"}),e.jsx("span",{className:"font-medium",children:a.includeHeaders?"Yes":"No"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-4 p-4 bg-gradient-to-r from-red-50 to-blue-50 dark:from-red-900/20 dark:to-blue-900/20 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(w,{className:"w-8 h-8 text-red-500 mx-auto mb-1"}),e.jsx("div",{className:"text-xs text-gray-600",children:"PDF Input"})]}),e.jsx("div",{className:"flex-1 border-t-2 border-dashed border-gray-300"}),e.jsxs("div",{className:"text-center",children:[e.jsx(_,{className:"w-8 h-8 text-blue-500 mx-auto mb-1"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Text Extraction"})]}),e.jsx("div",{className:"flex-1 border-t-2 border-dashed border-gray-300"}),e.jsxs("div",{className:"text-center",children:[e.jsx(p,{className:"w-8 h-8 text-green-500 mx-auto mb-1"}),e.jsxs("div",{className:"text-xs text-gray-600",children:[a.format.toUpperCase()," Output"]})]})]})]})]}):e.jsx("div",{className:"flex items-center justify-center h-64 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx(p,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Upload a PDF to see conversion preview"})]})})});return e.jsx(Y,{title:"PDF to Word",description:"Convert PDF documents to Word, RTF, or plain text formats",icon:e.jsx(p,{className:"w-6 h-6 text-red-600"}),settingsContent:I,previewContent:R})};export{ae as default};
