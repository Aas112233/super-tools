import{j as e}from"./index-425a4db3.js";import{r as m}from"./vendor-8a332d8f.js";import{P,r as L,d as F}from"./PDFButton-bafdfd11.js";import{P as O,a as M,F as J}from"./PdfProgress-f427ce92.js";import{P as _}from"./PdfToolWrapper-bef57729.js";import{F as q,D as p,T as G,I as H,E as K}from"./ui-86c81d4e.js";import"./router-2c18f3be.js";import"./tslib.es6-1f0a9ae4.js";const re=()=>{const[o,S]=m.useState(null),[a,d]=m.useState({type:"text",text:"CONFIDENTIAL",fontSize:48,opacity:.3,rotation:0,position:"center",color:"#FF0000",imageFile:null,imageScale:1}),[u,g]=m.useState("idle"),[D,n]=m.useState(0),[C,i]=m.useState(""),[b,j]=m.useState(null),[I,W]=m.useState(0),z=m.useCallback(async r=>{if(r.length>0){const t=r[0];S(t),g("idle"),n(0),i(""),j(null);try{const s=await t.arrayBuffer(),y=(await P.load(s)).getPageCount();W(y),i(`PDF loaded with ${y} pages`)}catch(s){console.error("Error loading PDF:",s),i("Failed to load PDF file")}}},[]),T=r=>{var s;const t=(s=r.target.files)==null?void 0:s[0];t&&(t.type==="image/png"||t.type==="image/jpeg")&&d(l=>({...l,imageFile:t}))},B=r=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return t?{r:parseInt(t[1],16)/255,g:parseInt(t[2],16)/255,b:parseInt(t[3],16)/255}:{r:1,g:0,b:0}},k=(r,t,s,l)=>{switch(a.position){case"top-left":return{x:50,y:t-50};case"top-right":return{x:r-s-50,y:t-50};case"bottom-left":return{x:50,y:50};case"bottom-right":return{x:r-s-50,y:50};default:return{x:(r-s)/2,y:(t-l)/2}}},E=async()=>{if(!o){g("error"),i("Please upload a PDF file first.");return}if(a.type==="text"&&!a.text.trim()){g("error"),i("Please enter watermark text.");return}if(a.type==="image"&&!a.imageFile){g("error"),i("Please select an image file for watermark.");return}try{g("processing"),n(0),i("Loading PDF document...");const r=await o.arrayBuffer(),t=await P.load(r),s=t.getPages();n(20);let l=null;if(a.type==="image"&&a.imageFile){i("Embedding watermark image...");const x=await a.imageFile.arrayBuffer();a.imageFile.type==="image/png"?l=await t.embedPng(x):l=await t.embedJpg(x),n(40)}i("Applying watermark to pages...");for(let x=0;x<s.length;x++){const f=s[x],{width:w,height:N}=f.getSize();if(a.type==="text"){const c=B(a.color),h=a.text.length*a.fontSize*.6,v=k(w,N,h,a.fontSize);f.drawText(a.text,{x:v.x,y:v.y,size:a.fontSize,color:L(c.r,c.g,c.b),opacity:a.opacity,rotate:F(a.rotation)})}else if(l){const c=l.scale(a.imageScale),h=k(w,N,c.width,c.height);f.drawImage(l,{x:h.x,y:h.y,width:c.width,height:c.height,opacity:a.opacity,rotate:F(a.rotation)})}n(40+(x+1)/s.length*40)}n(80),i("Saving watermarked PDF...");const y=await t.save();n(90),i("Finalizing PDF...");const U=new Blob([y],{type:"application/pdf"});j(U),n(100),g("success"),i(`Successfully added watermark to ${s.length} pages!`)}catch(r){console.error("Error adding watermark:",r),g("error"),i("Failed to add watermark. Please ensure the file is a valid PDF.")}},$=()=>{if(b){const r=`watermarked-${(o==null?void 0:o.name)||"document.pdf"}`;J.saveAs(b,r)}},A=e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(q,{className:"w-5 h-5 text-red-500"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Upload PDF File"})]}),e.jsx(O,{onFilesSelected:z,multiple:!1,accept:{"application/pdf":[".pdf"]},disabled:u==="processing"})]}),o&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(p,{className:"w-5 h-5 text-red-500"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Watermark Settings"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Watermark Type"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>d(r=>({...r,type:"text"})),className:`p-3 rounded-lg border-2 transition-all flex items-center space-x-2 ${a.type==="text"?"border-red-500 bg-red-50 dark:bg-red-900/30":"border-gray-200 dark:border-gray-600 hover:border-red-300"}`,children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Text"})]}),e.jsxs("button",{onClick:()=>d(r=>({...r,type:"image"})),className:`p-3 rounded-lg border-2 transition-all flex items-center space-x-2 ${a.type==="image"?"border-red-500 bg-red-50 dark:bg-red-900/30":"border-gray-200 dark:border-gray-600 hover:border-red-300"}`,children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Image"})]})]})]}),a.type==="text"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Watermark Text"}),e.jsx("input",{type:"text",value:a.text,onChange:r=>d(t=>({...t,text:r.target.value})),placeholder:"Enter watermark text",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-red-500 focus:border-red-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Font Size"}),e.jsx("input",{type:"number",min:"8",max:"200",value:a.fontSize,onChange:r=>d(t=>({...t,fontSize:parseInt(r.target.value)||48})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-red-500 focus:border-red-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Text Color"}),e.jsx("input",{type:"color",value:a.color,onChange:r=>d(t=>({...t,color:r.target.value})),className:"w-full h-10 border border-gray-300 rounded cursor-pointer"})]})]})]}),a.type==="image"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Watermark Image"}),e.jsx("input",{type:"file",accept:"image/png,image/jpeg",onChange:T,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-red-500 focus:border-red-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Image Scale: ",a.imageScale,"x"]}),e.jsx("input",{type:"range",min:"0.1",max:"2",step:"0.1",value:a.imageScale,onChange:r=>d(t=>({...t,imageScale:parseFloat(r.target.value)})),className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Opacity: ",Math.round(a.opacity*100),"%"]}),e.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:a.opacity,onChange:r=>d(t=>({...t,opacity:parseFloat(r.target.value)})),className:"w-full"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Rotation: ",a.rotation,"°"]}),e.jsx("input",{type:"range",min:"-90",max:"90",step:"15",value:a.rotation,onChange:r=>d(t=>({...t,rotation:parseInt(r.target.value)})),className:"w-full"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Position"}),e.jsxs("select",{value:a.position,onChange:r=>d(t=>({...t,position:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-red-500 focus:border-red-500",children:[e.jsx("option",{value:"center",children:"Center"}),e.jsx("option",{value:"top-left",children:"Top Left"}),e.jsx("option",{value:"top-right",children:"Top Right"}),e.jsx("option",{value:"bottom-left",children:"Bottom Left"}),e.jsx("option",{value:"bottom-right",children:"Bottom Right"})]})]}),e.jsxs("button",{onClick:E,disabled:!o||u==="processing",className:"w-full px-4 py-3 bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white font-medium rounded-lg transition-colors disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:[e.jsx(p,{className:"w-5 h-5"}),e.jsx("span",{children:"Add Watermark"})]})]})]}),e.jsx(M,{status:u,progress:D,message:C,onDownload:$,downloadFileName:b?`watermarked-${o==null?void 0:o.name}`:void 0}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-red-900 dark:text-red-100 mb-2",children:"How to use PDF Add Watermark:"}),e.jsxs("ul",{className:"text-sm text-red-800 dark:text-red-200 space-y-1",children:[e.jsx("li",{children:"• Upload a PDF file using the upload area above"}),e.jsx("li",{children:"• Choose between text or image watermark"}),e.jsx("li",{children:"• Configure watermark appearance and position"}),e.jsx("li",{children:'• Click "Add Watermark" to process the document'}),e.jsx("li",{children:"• Download the watermarked PDF when processing is complete"})]})]})]}),R=e.jsx("div",{className:"space-y-6",children:o&&I>0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(K,{className:"w-5 h-5 text-red-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Watermark Preview"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-lg p-8 flex items-center justify-center relative h-64",children:e.jsxs("div",{className:"relative bg-white border-2 border-gray-300 rounded-lg w-48 h-56 flex items-center justify-center shadow-lg",children:[a.type==="text"&&a.text?e.jsx("span",{className:"absolute select-none font-bold",style:{color:a.color,opacity:a.opacity,fontSize:Math.max(8,a.fontSize/4),transform:`rotate(${a.rotation}deg)`},children:a.text}):a.type==="image"&&a.imageFile?e.jsx("div",{className:"absolute",style:{opacity:a.opacity,transform:`rotate(${a.rotation}deg) scale(${a.imageScale})`},children:e.jsx("img",{src:URL.createObjectURL(a.imageFile),alt:"Watermark preview",className:"max-w-16 max-h-16"})}):e.jsxs("div",{className:"text-gray-400 text-center",children:[e.jsx(p,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("span",{className:"text-sm",children:"Watermark Preview"})]}),e.jsx("div",{className:"absolute bottom-2 text-xs text-gray-400 text-center w-full",children:"PDF Page"})]})}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Watermark Settings"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Type:"}),e.jsx("span",{className:"font-medium capitalize",children:a.type})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Position:"}),e.jsx("span",{className:"font-medium",children:a.position})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Opacity:"}),e.jsxs("span",{className:"font-medium",children:[Math.round(a.opacity*100),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Rotation:"}),e.jsxs("span",{className:"font-medium",children:[a.rotation,"°"]})]})]})]})]})]})]}):e.jsx("div",{className:"flex items-center justify-center h-64 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx(p,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Upload a PDF to see watermark preview"})]})})});return e.jsx(_,{title:"Add Watermark",description:"Add text or image watermarks to PDF documents with customizable positioning",icon:e.jsx(p,{className:"w-6 h-6 text-red-600"}),settingsContent:A,previewContent:R})};export{re as default};
